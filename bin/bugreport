#!/usr/bin/env php
<?php

if (PHP_SAPI !== 'cli') {
    echo 'Warning: bugreport may only be invoked from a command line', PHP_EOL;
}

require_once __DIR__ . '/../vendor/autoload.php';

use BugReport\Command\BugReport as BugReportCommand;
use BugReport\Service\BugReport as BugReportService;
use BugReport\Service\Config;
use Github\Client;
use Github\ResultPager;
use Symfony\Component\Console\Application;
use Symfony\Component\Console\Input\ArgvInput;

$application = new Application();

$client = new Client();
$pager = new ResultPager($client);
$config = new Config(getcwd() . DIRECTORY_SEPARATOR . 'bugreport.json');
$service = new BugReportService($client, $pager, $config);

$defaultCommand = new BugReportCommand($service);

$application->add($defaultCommand);
$application->setDefaultCommand($defaultCommand->getName(), true);

$application->run();
